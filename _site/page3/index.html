<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Kiddinglife</title>
    <meta name="description" content="">

    <link rel="shortcut icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_8v3czwksspqlg14i.css">
    <link rel="stylesheet" href="/css/main.css ">
    <link rel="canonical" href="http://localhost:1234/page3/">
    <link rel="alternate" type="application/rss+xml" title="Kiddinglife" href="http://localhost:1234/feed.xml ">


    <script>
    // 百度统计代码
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?cf8506e0ef223e57ff6239944e5d46a4";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
    </script>


    <script>
    // google analytics
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-72449510-4', 'auto');
      ga('send', 'pageview');

    </script>

</head>


  <body>

    <header id="top">
    <div class="wrapper">
        <a href="/" class="brand">Kiddinglife</a>
        <small>C/C++/PYTHON ENGINEER</small>
        <button id="headerMenu" class="menu"><i class="fa fa-bars"></i></button>
        <nav id="headerNav">
            <ul>
                <li>
                    
                    <a href="/">
                    
                        <i class="fa fa-home"></i>Home
                    </a>
                </li>

                
                    
                    <li>
                        
                        <a href="/archive/">
                        
                            <i class="fa fa-archive"></i>Archives
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/category/">
                        
                            <i class="fa fa-th-list"></i>Categories
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/tag/">
                        
                            <i class="fa fa-tags"></i>Tags
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/collection/">
                        
                            <i class="fa fa-bookmark"></i>Collections
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/demo/">
                        
                            <i class="fa fa-play"></i>Demo
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/about/">
                        
                            <i class="fa fa-heart"></i>About
                        </a>
                    </li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        </nav>
    </div>
</header>


        <div class="page clearfix" index>
    <div class="left">
        <h1>For My Youth Dedicated to Programming</h1>
        <small>this blog is used to refine my knowledges about IT</small>
        <hr>
        <ul>
            
              <li>
                <h2>
                  <a class="post-link" href="/2016/03/23/good-logging-practice/">Good Logging Practices</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2016-03-23
                    </div>
                    <div class="label-card">
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#logging" title="Category: logging" rel="category">logging</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                    <div class="label-card">
                    
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <a href="/tag/#debug" title="Tag: debug" rel="tag">debug</a>
    
  

</span>

                    </div>
                </div>
                <div class="excerpt">
                    <ul id="markdown-toc">
  <li><a href="#1-good-or-bad-logging" id="markdown-toc-1-good-or-bad-logging">1 Good or Bad Logging</a></li>
  <li><a href="#2-never-log-too-much" id="markdown-toc-2-never-log-too-much">2 Never log too much</a></li>
  <li><a href="#3-never-log-too-little" id="markdown-toc-3-never-log-too-little">3 Never log too little</a></li>
  <li><a href="#4-good-things-to-log" id="markdown-toc-4-good-things-to-log">4 Good things to log</a></li>
  <li><a href="#5-bad-things-to-log" id="markdown-toc-5-bad-things-to-log">5 Bad things to log</a></li>
  <li><a href="#6-more-than-one-logging-level" id="markdown-toc-6-more-than-one-logging-level">6 More Than One Logging Level</a></li>
  <li><a href="#7-more-than-one-logging-category" id="markdown-toc-7-more-than-one-logging-category">7 More Than One Logging Category</a></li>
  <li><a href="#8-use-unique-identifiers" id="markdown-toc-8-use-unique-identifiers">8 Use Unique Identifiers</a></li>
  <li><a href="#9-log-timing-infos" id="markdown-toc-9-log-timing-infos">9 Log Timing Infos</a></li>
  <li><a href="#10-use-log-queue" id="markdown-toc-10-use-log-queue">10 Use Log Queue</a></li>
  <li><a href="#11-always-improve-logging" id="markdown-toc-11-always-improve-logging">11 Always Improve Logging</a></li>
</ul>

<h4 id="1-good-or-bad-logging">1 Good or Bad Logging</h4>
<p>How long does it take to find the root cause of a failure in your system?</p>
<ul>
  <li>tens of minutes
    <ul>
      <li>it’s very likely that your production system and tests have great logging</li>
    </ul>
  </li>
  <li>tens of hours
    <ul>
      <li>it’s very likely that your production system and tests have poor logging</li>
    </ul>
  </li>
</ul>

<h4 id="2-never-log-too-much">2 Never log too much</h4>
<p>If you log too much, you’ll need to:</p>
<ul>
  <li>devise complex approaches to minimize disk access,</li>
  <li>maintain log history, archive large quantities of data,</li>
  <li>query these large sets of data.</li>
  <li>make it very difficult to find valuable information.</li>
</ul>

<h4 id="3-never-log-too-little">3 Never log too little</h4>
<p>normally two main goals of logging:</p>
<ul>
  <li>help with bug investigation</li>
  <li>and event confirmation.</li>
</ul>

<p>If your log can’t explain the cause of a bug or whether a certain transaction took place,<br />
you are logging too little.</p>

<h4 id="4-good-things-to-log">4 Good things to log</h4>
<ul>
  <li>Important startup configuration</li>
  <li>Errors</li>
  <li>Warnings</li>
  <li>Changes to persistent data</li>
  <li>Requests and responses between major system components</li>
  <li>Significant state changes</li>
  <li>User interactions</li>
  <li>Calls with a known risk of failure</li>
  <li>Waits on conditions that could take measurable time to satisfy</li>
  <li>Periodic progress during long-running tasks</li>
  <li>Significant branch points of logic and conditions that led to the branch</li>
  <li>Summaries of processing steps or events from high level functions.<br />
Avoid logging every step of a complex process in low-level functions.</li>
</ul>

<h4 id="5-bad-things-to-log">5 Bad things to log</h4>
<ul>
  <li>Function entry.
    <ul>
      <li>Don’t log a function entry unless it is significant or logged at the debug level.</li>
    </ul>
  </li>
  <li>Data within a loop.
    <ul>
      <li>Avoid logging from many iterations of a loop.</li>
      <li>It is OK to log from iterations of small loops or to log periodically from large loops.</li>
    </ul>
  </li>
  <li>Content of large messages or files.
    <ul>
      <li>Truncate or summarize the data in some way that will be useful to debugging.</li>
    </ul>
  </li>
  <li>Benign errors.
    <ul>
      <li>Errors that are not really errors can confuse the log reader.</li>
      <li>This sometimes happens when exception handling is part of successful execution flow.</li>
    </ul>
  </li>
  <li>Repetitive errors.
    <ul>
      <li>Do not repetitively log the same or similar error.</li>
      <li>This can quickly fill a log and hide the actual cause.</li>
      <li>Frequency of error types is best handled by monitoring.</li>
      <li>Logs only need to capture detail for some of those errors.</li>
    </ul>
  </li>
  <li>Useless infos.</li>
</ul>

<h4 id="6-more-than-one-logging-level">6 More Than One Logging Level</h4>
<ul>
  <li>You can enable certain levels at system startup, which provides a convenient control for log verbosity.</li>
  <li>Practically speaking, only two log configurations are needed:
    <ul>
      <li>Production
        <ul>
          <li>Every level is enabled except debug.</li>
          <li>If something goes wrong in production, the logs should reveal the cause.</li>
        </ul>
      </li>
      <li>Development &amp; Debug
        <ul>
          <li>While developing new code or trying to reproduce a production issue, enable all levels.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>The classic levels are:
    <ul>
      <li>Debug
        <ul>
          <li>verbose and only useful while developing and/or debugging.</li>
        </ul>
      </li>
      <li>Info
        <ul>
          <li>the most popular level.</li>
          <li>should be helpful to locate warn,error and critical msg.</li>
          <li>usually should be &lt;= 10% of debug or trace logs.</li>
          <li>eg. subsystem initializations or a request succeeds.</li>
        </ul>
      </li>
      <li>Warning
        <ul>
          <li>strange or unexpected states that are acceptable.</li>
          <li>but if not solved, it may become normal or critical error</li>
          <li>eg. disk usage exceeding throuds.</li>
        </ul>
      </li>
      <li>Error
        <ul>
          <li>something went wrong, but the process can recover.</li>
        </ul>
      </li>
      <li>Critical
        <ul>
          <li>the process cannot recover, and it will shutdown or restart.</li>
          <li>Usually, the process logs only one critical msg once shutdown or restart.</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p>critical and error msgs are generated when application itself goes wrong<br />
and problems need to be fixed by external forces like developer or system admin.</p>

<p>the process actually died if critical msg happens while the process is still alive<br />
but cannot provide service if error msg happens.</p>

<h4 id="7-more-than-one-logging-category">7 More Than One Logging Category</h4>
<p>The classic categories are (based on functionality):</p>
<ul>
  <li>Diagnostic log
    <ul>
      <li>network request entry and exit</li>
      <li>external service invocation and return</li>
      <li>resource operation: open file handler</li>
      <li>error-tolerant operation</li>
      <li>program error: fail to connect to db</li>
      <li>background operation: resource clean up</li>
      <li>startup and close process and load configures</li>
      <li>do not log when exception thrown</li>
    </ul>
  </li>
  <li>Statistical log
    <ul>
      <li>user visits</li>
      <li>billing log</li>
      <li>resource log: network or disk usage</li>
    </ul>
  </li>
  <li>Monitoring log
    <ul>
      <li>administration operation</li>
    </ul>
  </li>
</ul>

<p>Statistical log and Diagnostic log complement each other</p>
<ul>
  <li>Statistical log shows the symptoms of problems and Diagnostic</li>
  <li>log shows details and state on individual transactions.</li>
</ul>

<p>For each log type above (request entry and exit and so on),<br />
they should:</p>
<ul>
  <li>write into different log files</li>
  <li>log different msgs with different formats</li>
</ul>

<h4 id="8-use-unique-identifiers">8 Use Unique Identifiers</h4>
<p>create unique identifiers for transactions that involve processing across<br />
many threads and/or processes to  makes it much easier to trace a specific<br />
transaction when many transactions are being processed concurrently.</p>
<ol>
  <li>initiator of the transaction should create the ID</li>
  <li>initiator passes id to every component that performs work for the transaction</li>
  <li>the id is logged by each component when logging information about the transaction</li>
</ol>

<h4 id="9-log-timing-infos">9 Log Timing Infos</h4>
<p>Logged timing data can help debug performance issues</p>
<ul>
  <li>eg. determine the cause of a timeout in a large system</li>
</ul>

<p>Logging the start and finish times of calls that can take measurable time:</p>
<ul>
  <li>Significant system calls</li>
  <li>Network requests</li>
  <li>CPU intensive operations</li>
  <li>Connected device interactions</li>
  <li>Transactions</li>
</ul>

<h4 id="10-use-log-queue">10 Use Log Queue</h4>
<ul>
  <li>When errors occur, the log should contain a lot of detail.</li>
  <li>Unfortunately, detail that led to an error is often unavailable once the error is encountered</li>
  <li>A good way to solve this problem is to create temporary, in-memory log queues.
    <ol>
      <li>Throughout processing of a transaction, append verbose details about each step to the queue.</li>
      <li>If the transaction completes successfully, discard the queue and log a summary.</li>
      <li>If an error is encountered, log the content of the entire queue and the error.</li>
    </ol>
  </li>
  <li>This technique is especially useful for test logging of system interactions.</li>
  <li><a href="https://github.com/egymgmbh/log-queue">An open-source implementation of log queue from GitHub</a></li>
</ul>

<h4 id="11-always-improve-logging">11 Always Improve Logging</h4>
<p>When problems occur, before fixing the problem:</p>
<ul>
  <li>fix your logging so that the logs clearly show the cause.
    <ul>
      <li>in development env
        <ul>
          <li>while writing new code, try to refrain from using <br />
debuggers and only use the logs.</li>
          <li>Do the logs describe what is going on? If not,the logging is insufficient.</li>
        </ul>
      </li>
      <li>in production env
        <ul>
          <li>if you cannot reproduce the problem, or you have a flaky test, <br />
enhance the logs so that the problem can be tracked down when it happens again.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>If this problem ever happens again, it’ll be much easier to identify.</li>
</ul>


                </div>
                <div class="read-all">
                    <a  href="/2016/03/23/good-logging-practice/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
              <li>
                <h2>
                  <a class="post-link" href="/2016/03/20/swig-basics/">SWIG-3-Basics-1</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2016-03-20
                    </div>
                    <div class="label-card">
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#tool" title="Category: tool" rel="category">tool</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                    <div class="label-card">
                    
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <a href="/tag/#swig" title="Tag: swig" rel="tag">swig</a>&nbsp;
    
        <a href="/tag/#script-language" title="Tag: script-language" rel="tag">script-language</a>&nbsp;
    
        <a href="/tag/#c/c++" title="Tag: c/c++" rel="tag">c/c++</a>
    
  

</span>

                    </div>
                </div>
                <div class="excerpt">
                    <ul id="markdown-toc">
  <li><a href="#52-wrapping-simple-c-declarations" id="markdown-toc-52-wrapping-simple-c-declarations">5.2 Wrapping Simple C Declarations</a>    <ul>
      <li><a href="#521-basic-type-handling" id="markdown-toc-521-basic-type-handling">5.2.1 Basic Type Handling</a>        <ul>
          <li><a href="#5211-integral" id="markdown-toc-5211-integral">5.2.1.1 Integral</a></li>
          <li><a href="#5212-float" id="markdown-toc-5212-float">5.2.1.2 Float</a></li>
          <li><a href="#5213-unicode" id="markdown-toc-5213-unicode">5.2.1.3 Unicode:</a></li>
        </ul>
      </li>
      <li><a href="#522-global-variables" id="markdown-toc-522-global-variables">5.2.2 Global Variables</a></li>
      <li><a href="#523-constants" id="markdown-toc-523-constants">5.2.3 Constants</a>        <ul>
          <li><a href="#5231-special-cases" id="markdown-toc-5231-special-cases">5.2.3.1 Special cases</a></li>
          <li><a href="#5232-a-brief-word-about-const" id="markdown-toc-5232-a-brief-word-about-const">5.2.3.2 A brief word about const</a></li>
        </ul>
      </li>
      <li><a href="#525-a-cautionary-tale-of-char-" id="markdown-toc-525-a-cautionary-tale-of-char-">5.2.5 A cautionary tale of char *</a></li>
    </ul>
  </li>
</ul>

<h2 id="52-wrapping-simple-c-declarations">5.2 Wrapping Simple C Declarations</h2>
<p>For example, consider the following interface file:</p>
<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="o">%</span><span class="n">module</span> <span class="n">example</span>
<span class="o">%</span><span class="kr">inline</span> <span class="o">%</span><span class="p">{</span>
<span class="k">extern</span> <span class="kt">double</span> <span class="n">sin</span><span class="p">(</span><span class="kt">double</span> <span class="n">x</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">strcmp</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">Foo</span><span class="p">;</span>
<span class="o">%</span><span class="p">}</span>
<span class="cp">#define STATUS 50
#define VERSION "1.1"
</span></code></pre>
</div>
<p>When SWIG creates an extension module, these declarations are accessible as scripting language functions, variables, and constants respectively. For example, in python:</p>
<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">example</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="mf">5.2335956</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">example</span><span class="o">.</span><span class="n">strcmp</span><span class="p">(</span><span class="s">'Dave'</span><span class="p">,</span> <span class="s">'Mike'</span><span class="p">)</span>
<span class="o">-</span><span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span> <span class="n">example</span><span class="o">.</span><span class="n">cvar</span><span class="o">.</span><span class="n">Foo</span>
<span class="mi">42</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span> <span class="n">example</span><span class="o">.</span><span class="n">STATUS</span>
<span class="mi">50</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span> <span class="n">example</span><span class="o">.</span><span class="n">VERSION</span>
<span class="mf">1.1</span>
</code></pre>
</div>
<p>Whenever possible, SWIG creates an interface that closely matches the underlying C/C++ code. However, due to subtle differences between languages, run-time environments, and semantics, it is not always possible to do so.</p>

<h3 id="521-basic-type-handling">5.2.1 Basic Type Handling</h3>
<p>In order to build an interface, SWIG has to convert C/C++ datatypes to equivalent types in the target language:</p>

<h4 id="5211-integral">5.2.1.1 Integral</h4>
<p>When an integral value is converted from C, a cast is used to convert it to the representation in the target language. Thus, a 16 bit short in C may be promoted to a 32 bit integer. When integers are converted in the other direction, the value is cast back into the original C type. If the value is too large to fit, <em>it is silently truncated.</em></p>

<p>bool datatype is cast to and from an integer value of 0 and 1 unless the target language provides a special boolean type.</p>

<p>unsigned/signed char are special cases that are handled as small 8-bit integers. Normally, the char datatype is mapped as a one-character ASCII string.</p>

<p><em>As a rule of thumb, the int datatype and all variations of char and short datatypes are safe to use. For unsigned int and long datatypes, you will need to carefully check the correct operation of your program after it has been wrapped with SWIG.</em></p>

<h4 id="5212-float">5.2.1.2 Float</h4>
<p>SWIG recognizes the following floating point types : float and double. Floating point numbers are mapped to and from the natural representation of floats in the target language. This is almost always a C <em>double</em>.</p>

<h4 id="5213-unicode">5.2.1.3 Unicode:</h4>
<p>For those scripting languages that provide Unicode support, Unicode strings are often available in an 8-bit representation such as UTF-8 that can be mapped to the char * type (in which case the SWIG interface will probably work).</p>

<h3 id="522-global-variables">5.2.2 Global Variables</h3>
<p>Whenever possible, SWIG maps C/C++ global variables into scripting language variables.</p>

<p>Whenever the scripting language variable is used, the underlying C global variable is accessed。However, the way to access global variables in different script langs are different.</p>

<p>Finally, if a global variable has been declared as const, it only supports read-only access.</p>

<p>For example:</p>
<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="o">%</span><span class="n">module</span> <span class="n">example</span>
<span class="kt">double</span> <span class="n">foo</span><span class="p">;</span>
</code></pre>
</div>
<p>results in a scripting language variable like this:</p>
<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="cp"># Tcl
</span><span class="n">set</span> <span class="n">foo</span> <span class="p">[</span><span class="mf">3.5</span><span class="p">]</span>                   <span class="p">;</span><span class="err">#</span> <span class="n">Set</span> <span class="n">foo</span> <span class="n">to</span> <span class="mf">3.5</span>
<span class="n">puts</span> <span class="err">$</span><span class="n">foo</span>                       <span class="p">;</span><span class="err">#</span> <span class="n">Print</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span> <span class="n">foo</span>
<span class="cp"># Python
</span><span class="n">cvar</span><span class="p">.</span><span class="n">foo</span> <span class="o">=</span> <span class="mf">3.5</span>                  <span class="err">#</span> <span class="n">Set</span> <span class="n">foo</span> <span class="n">to</span> <span class="mf">3.5</span>
<span class="n">print</span> <span class="n">cvar</span><span class="p">.</span><span class="n">foo</span>                  <span class="err">#</span> <span class="n">Print</span> <span class="n">value</span> <span class="n">of</span> <span class="n">foo</span>
<span class="cp"># Perl
</span><span class="err">$</span><span class="n">foo</span> <span class="o">=</span> <span class="mf">3.5</span><span class="p">;</span>                     <span class="err">#</span> <span class="n">Set</span> <span class="n">foo</span> <span class="n">to</span> <span class="mf">3.5</span>
<span class="n">print</span> <span class="err">$</span><span class="n">foo</span><span class="p">,</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>               <span class="err">#</span> <span class="n">Print</span> <span class="n">value</span> <span class="n">of</span> <span class="n">foo</span>
<span class="cp"># Ruby
</span><span class="n">Module</span><span class="p">.</span><span class="n">foo</span> <span class="o">=</span> <span class="mf">3.5</span>               <span class="err">#</span> <span class="n">Set</span> <span class="n">foo</span> <span class="n">to</span> <span class="mf">3.5</span>
<span class="n">print</span> <span class="n">Module</span><span class="p">.</span><span class="n">foo</span><span class="p">,</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span>         <span class="err">#</span> <span class="n">Print</span> <span class="n">value</span> <span class="n">of</span> <span class="n">foo</span>
</code></pre>
</div>

<h3 id="523-constants">5.2.3 Constants</h3>
<p>Constants can be created using #define, enumerations, or a special %constant directive. The following interface file shows a few valid constant declarations :</p>
<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="cp">#define I_CONST       5               // An integer constant
#define PI            3.14159         // A Floating point constant
#define S_CONST       "hello world"   // A string constant
#define NEWLINE       '\n'            // Character constant
</span><span class="k">enum</span> <span class="n">boolean</span> <span class="p">{</span><span class="n">NO</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">YES</span><span class="o">=</span><span class="mi">1</span><span class="p">};</span>
<span class="k">enum</span> <span class="n">months</span> <span class="p">{</span><span class="n">JAN</span><span class="p">,</span> <span class="n">FEB</span><span class="p">,</span> <span class="n">MAR</span><span class="p">,</span> <span class="n">APR</span><span class="p">,</span> <span class="n">MAY</span><span class="p">,</span> <span class="n">JUN</span><span class="p">,</span> <span class="n">JUL</span><span class="p">,</span> <span class="n">AUG</span><span class="p">,</span>
             <span class="n">SEP</span><span class="p">,</span> <span class="n">OCT</span><span class="p">,</span> <span class="n">NOV</span><span class="p">,</span> <span class="n">DEC</span><span class="p">};</span>
<span class="o">%</span><span class="n">constant</span> <span class="kt">double</span> <span class="n">BLAH</span> <span class="o">=</span> <span class="mf">42.37</span><span class="p">;</span>
<span class="cp">#define PI_4 PI/4
#define FLAGS 0x04 | 0x08 | 0x40
</span></code></pre>
</div>

<h4 id="5231-special-cases">5.2.3.1 Special cases</h4>
<p>1.SWIG will not create constants for macros unless the value can be completely determined by the preprocessor.</p>
<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="cp">#define EXTERN extern
</span><span class="n">EXTERN</span> <span class="kt">void</span> <span class="n">foo</span><span class="p">();</span>
</code></pre>
</div>
<p>what would the value of a constant called EXTERN would be?</p>

<p>2.for the same conservative reasons even a constant with a simple cast will be ignored, such as</p>
<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="cp">#define F_CONST (double) 5 // A floating point constant with cast
</span></code></pre>
</div>

<p>3.For enumerations, it is critical that the original enum definition be included somewhere in the interface file (either in a header file or in the %{ %} block) because it needs the original enumeration declaration in order to get the correct enum values as assigned by the C compiler.</p>

<h4 id="5232-a-brief-word-about-const">5.2.3.2 A brief word about const</h4>
<p>Typically, %constant is only used when you want to add constants to the scripting language interface that are not defined in the original header file.</p>

<p>If the right-most const occurs after all other type modifiers (such as pointers), then the variable is const. Otherwise, it is not. Here are some examples of const declarations:</p>
<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="k">const</span> <span class="kt">char</span> <span class="n">a</span><span class="p">;</span>           <span class="c1">// A constant character
</span><span class="kt">char</span> <span class="k">const</span> <span class="n">b</span><span class="p">;</span>           <span class="c1">// A constant character (the same)
</span><span class="kt">char</span> <span class="o">*</span><span class="k">const</span> <span class="n">c</span><span class="p">;</span>          <span class="c1">// A constant pointer to a character
</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="k">const</span> <span class="n">d</span><span class="p">;</span>    <span class="c1">// A constant pointer to a constant character
</span></code></pre>
</div>
<p>Here is an example of a declaration that is not const:</p>
<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">e</span><span class="p">;</span> 
</code></pre>
</div>
<p>In this case, the pointer e can change — it’s only the value being pointed to that is read-only.</p>

<h3 id="525-a-cautionary-tale-of-char-">5.2.5 A cautionary tale of char *</h3>
<p>When strings are passed from a scripting language to a C char *, the pointer usually points to string data stored inside the interpreter.</p>
<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="kt">char</span> <span class="o">*</span><span class="n">strcat</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">t</span><span class="p">)</span>
</code></pre>
</div>
<p>your application will perhaps crashes with a segmentation fault or other memory related problem. This is because s refers to some internal data in the target language—data that you shouldn’t be touching.</p>


                </div>
                <div class="read-all">
                    <a  href="/2016/03/20/swig-basics/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
              <li>
                <h2>
                  <a class="post-link" href="/2016/03/19/swig-2-scripting-lang/">SWIG-2-script-lang</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2016-03-19
                    </div>
                    <div class="label-card">
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#tool" title="Category: tool" rel="category">tool</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                    <div class="label-card">
                    
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <a href="/tag/#swig" title="Tag: swig" rel="tag">swig</a>&nbsp;
    
        <a href="/tag/#script-language" title="Tag: script-language" rel="tag">script-language</a>&nbsp;
    
        <a href="/tag/#c/c++" title="Tag: c/c++" rel="tag">c/c++</a>
    
  

</span>

                    </div>
                </div>
                <div class="excerpt">
                    <ul id="markdown-toc">
  <li><a href="#42-how-does-a-script-lang-talk-to-c" id="markdown-toc-42-how-does-a-script-lang-talk-to-c">4.2 How does a script lang talk to C?</a>    <ul>
      <li><a href="#421-wrapper-functions" id="markdown-toc-421-wrapper-functions">4.2.1 Wrapper functions</a></li>
      <li><a href="#422-variable-linking" id="markdown-toc-422-variable-linking">4.2.2 Variable linking</a></li>
      <li><a href="#423-constants" id="markdown-toc-423-constants">4.2.3 Constants</a></li>
      <li><a href="#424-structures-and-classes" id="markdown-toc-424-structures-and-classes">4.2.4 Structures and classes</a></li>
      <li><a href="#425-proxy-classes" id="markdown-toc-425-proxy-classes">4.2.5 Proxy classes</a></li>
    </ul>
  </li>
</ul>

<p>This blog provides a brief overview of:</p>
<ol>
  <li>script language extension programming</li>
  <li>mechanisms by which script lang interpreters access C and C++ code</li>
</ol>

<p>C/C++ can be used for maximal performance and complicated systems programming tasks.<br />
Scripting languages can be used for rapid prototyping, interactive debugging, scripting, 
and access to high-level data structures such associative arrays.</p>

<h2 id="42-how-does-a-script-lang-talk-to-c">4.2 How does a script lang talk to C?</h2>
<p>By extending the interpreter, it is usually possible to add new commands and variables.</p>

<p>To do this, most lang define a special API for adding new commands. Furthermore, a special foreign function interface 
defines how these new commands are supposed to hook into the interpreter.</p>

<p>Typically, when you add a new command to a scripting interpreter you need to do two things:</p>
<ul>
  <li>first you need to write a special “wrapper” function that serves as the glue between the 
interpreter and the underlying C function.</li>
  <li>Then you need to give the interpreter information about the wrapper by providing 
details about the name of the function, arguments, and so forth.</li>
</ul>

<h3 id="421-wrapper-functions">4.2.1 Wrapper functions</h3>
<p>Suppose you have an ordinary C function like this :</p>
<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">fact</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">else</span> <span class="k">return</span> <span class="n">n</span><span class="o">*</span><span class="n">fact</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>
</div>

<p>A wrapper function for it must do three things :</p>
<ul>
  <li>Gather function arguments and make sure they are valid.</li>
  <li>Call the C function.</li>
  <li>Convert the return value into a form recognized by the scripting language.</li>
</ul>

<p>As an example, the Tcl wrapper function for the fact() function above example might look like the following :</p>
<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">wrap_fact</span><span class="p">(</span><span class="n">ClientData</span> <span class="n">clientData</span><span class="p">,</span> 
              <span class="n">Tcl_Interp</span> <span class="o">*</span><span class="n">interp</span><span class="p">,</span>
              <span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> 
              <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> 
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">result</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">arg0</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)</span> 
    <span class="p">{</span>
        <span class="n">interp</span><span class="o">-&gt;</span><span class="n">result</span> <span class="o">=</span> <span class="s">"wrong # args"</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">TCL_ERROR</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">arg0</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">fact</span><span class="p">(</span><span class="n">arg0</span><span class="p">);</span>
    <span class="n">sprintf</span><span class="p">(</span><span class="n">interp</span><span class="o">-&gt;</span><span class="n">result</span><span class="p">,</span><span class="s">"%d"</span><span class="p">,</span> <span class="n">result</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">TCL_OK</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>
<hr />
<p>Once you have created a wrapper function, the final step is to tell the scripting language about the new function. 
This is usually done in an initialization function called by the language when the module is loaded.</p>

<p>For example, adding the above function to the Tcl interpreter requires code like the following :</p>
<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">Wrap_Init</span><span class="p">(</span><span class="n">Tcl_Interp</span> <span class="o">*</span><span class="n">interp</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Tcl_CreateCommand</span><span class="p">(</span><span class="n">interp</span><span class="p">,</span> 
    <span class="s">"fact"</span><span class="p">,</span> <span class="n">wrap_fact</span><span class="p">,</span> 
    <span class="p">(</span><span class="n">ClientData</span><span class="p">)</span> <span class="nb">NULL</span><span class="p">,</span>
    <span class="p">(</span><span class="n">Tcl_CmdDeleteProc</span> <span class="o">*</span><span class="p">)</span> <span class="nb">NULL</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">TCL_OK</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>
<p>When executed, Tcl will now have a new command called “fact” that you can use like any other Tcl command.</p>

<p>Although the process of adding a new function to Tcl has been illustrated, the procedure is almost identical 
for Perl and Python. Both require special wrappers to be written and both need additional initialization code.
Only the specific details are different.</p>

<h3 id="422-variable-linking">4.2.2 Variable linking</h3>
<p>ariable linking refers to the problem of mapping a C/C++ global variable to a variable in the scripting language 
interpreter. For example, suppose you had the following variable: <code class="highlighter-rouge">double Foo = 3.5;</code></p>

<p>evaluating a variable such as $Foo might implicitly call the get function. Similarly, typing $Foo = 4 would call the 
underlying set function to change the value.</p>

<h3 id="423-constants">4.2.3 Constants</h3>
<p>In many cases, a C program or library may define a large collection of constants. For example:</p>
<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="cp">#define RED
</span><span class="mh">0xff0000</span>
<span class="cp">#define BLUE 0x0000ff
#define GREEN 0x00ff00
</span></code></pre>
</div>
<p>To make constants available, their values can be stored in scripting language variables such as $RED, $BLUE, and $GREEN.
Virtually all scripting languages provide C functions for creating variables so installing constants is usually a trivial 
exercise.</p>

<h3 id="424-structures-and-classes">4.2.4 Structures and classes</h3>
<p>The most straightforward technique for handling structures is to implement a collection of accessor functions that hide the underlying representation of a structure. For example:</p>
<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="k">struct</span> <span class="n">Vector</span> <span class="p">{</span>
  <span class="n">Vector</span><span class="p">();</span>
  <span class="o">~</span><span class="n">Vector</span><span class="p">();</span>
  <span class="kt">double</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">;</span>
<span class="p">};</span>
</code></pre>
</div>
<p>can be transformed into the following set of functions :</p>
<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="n">Vector</span> <span class="o">*</span><span class="n">new_Vector</span><span class="p">();</span>
<span class="kt">void</span> <span class="n">delete_Vector</span><span class="p">(</span><span class="n">Vector</span> <span class="o">*</span><span class="n">v</span><span class="p">);</span>
<span class="kt">double</span> <span class="n">Vector_x_get</span><span class="p">(</span><span class="n">Vector</span> <span class="o">*</span><span class="n">v</span><span class="p">);</span>
<span class="kt">double</span> <span class="n">Vector_y_get</span><span class="p">(</span><span class="n">Vector</span> <span class="o">*</span><span class="n">v</span><span class="p">);</span>
<span class="kt">double</span> <span class="n">Vector_z_get</span><span class="p">(</span><span class="n">Vector</span> <span class="o">*</span><span class="n">v</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">Vector_x_set</span><span class="p">(</span><span class="n">Vector</span> <span class="o">*</span><span class="n">v</span><span class="p">,</span> <span class="kt">double</span> <span class="n">x</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">Vector_y_set</span><span class="p">(</span><span class="n">Vector</span> <span class="o">*</span><span class="n">v</span><span class="p">,</span> <span class="kt">double</span> <span class="n">y</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">Vector_z_set</span><span class="p">(</span><span class="n">Vector</span> <span class="o">*</span><span class="n">v</span><span class="p">,</span> <span class="kt">double</span> <span class="n">z</span><span class="p">);</span>
</code></pre>
</div>
<p>Now, from an interpreter these function might be used as follows:</p>
<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="o">%</span> <span class="n">set</span> <span class="n">v</span> <span class="p">[</span><span class="n">new_Vector</span><span class="p">]</span>
<span class="o">%</span> <span class="n">Vector_x_set</span> <span class="err">$</span><span class="n">v</span> <span class="mf">3.5</span>
<span class="o">%</span> <span class="n">Vector_y_get</span> <span class="err">$</span><span class="n">v</span>
<span class="o">%</span> <span class="n">delete_Vector</span> <span class="err">$</span><span class="n">v</span>
<span class="o">%</span> <span class="p">...</span>
</code></pre>
</div>
<p>Since accessor functions provide a mechanism for accessing the internals of an object, the interpreter does not need to know anything about the actual representation of a Vector.</p>

<h3 id="425-proxy-classes">4.2.5 Proxy classes</h3>
<p>In certain cases, it is possible to use the low-level accessor functions to create a proxy class, also known as a shadow class. For example, if you have the following C++ definition :</p>
<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Vector</span> 
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
  <span class="n">Vector</span><span class="p">();</span>
  <span class="o">~</span><span class="n">Vector</span><span class="p">();</span>
  <span class="kt">double</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">;</span>
<span class="p">};</span>
</code></pre>
</div>
<p>proxy classing mechanism would allow you to access the structure in a more natural manner from the interpreter. For example, in Python, you might want to do this:</p>
<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">v</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">3</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">v</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">4</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">v</span><span class="p">.</span><span class="n">z</span> <span class="o">=</span> <span class="o">-</span><span class="mi">13</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">del</span> <span class="n">v</span>
</code></pre>
</div>
<p>In the following blogs, we will go to the details of proxy class. See you then!</p>

                </div>
                <div class="read-all">
                    <a  href="/2016/03/19/swig-2-scripting-lang/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
              <li>
                <h2>
                  <a class="post-link" href="/2016/03/18/lock-free-multi-process-shared-memory/">lock-free-multi-process-shared-memory</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2016-03-18
                    </div>
                    <div class="label-card">
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#ipc" title="Category: ipc" rel="category">ipc</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                    <div class="label-card">
                    
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <a href="/tag/#os" title="Tag: os" rel="tag">os</a>&nbsp;
    
        <a href="/tag/#lock-free" title="Tag: lock-free" rel="tag">lock-free</a>
    
  

</span>

                    </div>
                </div>
                <div class="excerpt">
                    <ul id="markdown-toc">
  <li><a href="#how-to-make-lock-free-ipc-communication-between" id="markdown-toc-how-to-make-lock-free-ipc-communication-between">How to make lock free ipc communication between</a>    <ul>
      <li><a href="#option-1" id="markdown-toc-option-1">OPTION 1:</a></li>
      <li><a href="#option2" id="markdown-toc-option2">OPTION2:</a></li>
    </ul>
  </li>
</ul>

<h3 id="how-to-make-lock-free-ipc-communication-between">How to make lock free ipc communication between</h3>
<p>a single writer and a single reader via shared-memory ?</p>

<h4 id="option-1">OPTION 1:</h4>
<p>two fifo q1 and q2 used to simlate biodirectional data flows bwtween p1 and p2.</p>

<p>no lock required at all. queue refers to linux lock free queue.</p>

<p>q1: t1 as writer and t2 as reader so single data flow p1—&gt;p2<br />
q2: t1 as reader and t2 as writer so single data flow p1&lt;—p2</p>

<p>when writer writes all buffer, return error code of ENOBUF to 
caller just as socket does</p>

<h4 id="option2">OPTION2:</h4>
<p>这种单独单写的连原子操作都不需要，更不要说mutex之类的了。</p>

<p>假设A,B两进程通信</p>

<p>首先，将共享内存区域分成n块，如何分自己定义。</p>

<p>其次，每块内存指定一个byte做标志，</p>

<p>定义为: 0为A可读写状态，B不可读写；<br />
       1为B可读写状态，A不可读写。<br />
A的行为：
          遍历n块内存，找到一个标志为0的：
          接收：
          查看是否有B发来的消息，有，则接收，设置为可发送状态；
          发送：消息复制到该块区域，设置标志为1；
B的行为:
          遍历n块内存，找到一个标志为1的：
          接收：
          查看是否有B发来的消息，有，则接收，设置为可发送状态；
          发送：消息复制到该块区域，设置标志为0；</p>


                </div>
                <div class="read-all">
                    <a  href="/2016/03/18/lock-free-multi-process-shared-memory/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
              <li>
                <h2>
                  <a class="post-link" href="/2016/03/17/swig-1-intro/">SWIG-1-Introductions</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2016-03-17
                    </div>
                    <div class="label-card">
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#tool" title="Category: tool" rel="category">tool</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                    <div class="label-card">
                    
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <a href="/tag/#swig" title="Tag: swig" rel="tag">swig</a>&nbsp;
    
        <a href="/tag/#script-language" title="Tag: script-language" rel="tag">script-language</a>&nbsp;
    
        <a href="/tag/#c/c++" title="Tag: c/c++" rel="tag">c/c++</a>
    
  

</span>

                    </div>
                </div>
                <div class="excerpt">
                    <ul id="markdown-toc">
  <li><a href="#21-what-is-swig" id="markdown-toc-21-what-is-swig">2.1 What is SWIG?</a></li>
  <li><a href="#22-why-use-swig" id="markdown-toc-22-why-use-swig">2.2 Why use SWIG?</a></li>
  <li><a href="#24-supported-cc-language-features" id="markdown-toc-24-supported-cc-language-features">2.4 Supported C/C++ language features</a></li>
  <li><a href="#18-backwards-compatibility" id="markdown-toc-18-backwards-compatibility">1.8 Backwards compatibility</a></li>
  <li><a href="#112-installation" id="markdown-toc-112-installation">1.12 Installation</a>    <ul>
      <li><a href="#1121-windows-installation" id="markdown-toc-1121-windows-installation">1.12.1 Windows installation</a></li>
      <li><a href="#1122-unix-installation" id="markdown-toc-1122-unix-installation">1.12.2 Unix installation</a></li>
      <li><a href="#1124-testing" id="markdown-toc-1124-testing">1.12.4 Testing</a></li>
      <li><a href="#1125-examples" id="markdown-toc-1125-examples">1.12.5 Examples</a></li>
    </ul>
  </li>
</ul>

<h2 id="21-what-is-swig">2.1 What is SWIG?</h2>
<p>In a nutshell, SWIG is a compiler that takes C/C++ declarations and creates the wrappers needed to access those 
declarations from other languages including Perl, Python, Tcl, Ruby, Guile, and Java.</p>

<p>Possible applications of SWIG include:</p>
<ul>
  <li>Building interpreted interfaces to existing C programs.</li>
  <li>Rapid prototyping and application development.</li>
  <li>Interactive debugging.</li>
  <li>Reengineering or refactoring of legacy software into scripting language components.</li>
  <li>Making a graphical user interface (using Tk for example).</li>
  <li>Testing of C libraries and programs (using scripts).</li>
  <li>Building high performance C modules for scripting languages.</li>
  <li>Making C programming more enjoyable (or tolerable depending on your point of view).</li>
  <li>Impressing your friends.</li>
  <li>Obtaining vast sums of research funding (although obviously not applicable to the author).</li>
</ul>

<h2 id="22-why-use-swig">2.2 Why use SWIG?</h2>
<p>let’s list a few problems with C/C++ programming:</p>
<ul>
  <li>Writing a user interface is rather painful (i.e., consider programming with MFC, X11, GTK, or any number of other
libraries).</li>
  <li>Testing is time consuming (the compile/debug cycle).</li>
  <li>Not easy to reconfigure or customize without recompilation.</li>
  <li>Modularization can be tricky.</li>
  <li>Security concerns (buffer overflows for instance).</li>
</ul>

<h2 id="24-supported-cc-language-features">2.4 Supported C/C++ language features</h2>
<ul>
  <li>Full C99 pre-processing.</li>
  <li>All ANSI C and C++ data types.</li>
  <li>Functions, variables, and constants.</li>
  <li>Classes.</li>
  <li>Single and multiple inheritance.</li>
  <li>Overloaded functions and methods.</li>
  <li>Overloaded operators.</li>
  <li>C++ templates (including member templates, specialization, and partial specialization).</li>
  <li>Namespaces.</li>
  <li>Variable length arguments.</li>
  <li>C++ smart pointers.</li>
</ul>

<h2 id="18-backwards-compatibility">1.8 Backwards compatibility</h2>
<p>If you are a previous user of SWIG, don’t expect SWIG to provide complete backwards compatibility.</p>

<p>If you need to work with different versions of SWIG and backwards compatibility is an issue, you can use the SWIG_VERSION preprocessor symbol which holds the version of SWIG being executed.</p>

<p>SWIG_VERSION is a hexadecimal integer such as 0x010311 (corresponding to SWIG-1.3.11). This can be used in an interface file to define different typemaps, take advantage of different features etc:</p>
<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="cp">#if SWIG_VERSION &gt;= 0x010311
</span><span class="cm">/*Use some fancy new feature */</span>
<span class="cp">#endif
</span></code></pre>
</div>

<h2 id="112-installation">1.12 Installation</h2>
<p>If you checked the code out via Git, you will have to run ./autogen.sh before ./configure.</p>
<h3 id="1121-windows-installation">1.12.1 Windows installation</h3>
<p>The Windows distribution is called swigwin and includes a prebuilt SWIG executable, swig.exe and so ypu do not need to compile it.</p>
<h3 id="1122-unix-installation">1.12.2 Unix installation</h3>
<p>To build and install SWIG, simply type the following:</p>
<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>./configure
<span class="gp">$ </span>make
<span class="gp">$ </span>make install
</code></pre>
</div>
<p>By default SWIG installs itself in /usr/local. If you need to install SWIG in a different location or in your home directory, use the –prefix option to ./configure. For example:</p>
<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>./configure --prefix<span class="o">=</span>/home/yourname/projects
<span class="gp">$ </span>make
<span class="gp">$ </span>make install
</code></pre>
</div>
<p>Note: the directory given to –prefix must be an absolute pathname. Do not use the ~ shell-escape to refer to your home 
directory. SWIG won’t work properly if you do this.</p>

<h3 id="1124-testing">1.12.4 Testing</h3>
<p>if you want to test SWIG after building it, a check can be performed on Unix operating systems. 
Type the following: <code class="highlighter-rouge">$ make -k check</code>  you can use parallel make to speed up the check as it does take quite some 
time to run, for example: <code class="highlighter-rouge">$ make -j2 -k check</code></p>

<p>Even if the check fails, there is a pretty good chance SWIG still works correctly — you will just have to mess 
around with one of the examples and some makefiles to get it to work.</p>

<p>Some tests may also fail due to missing dependency packages, eg PCRE or Boost, but this will require careful
analysis of the configure output done during configuration.</p>

<h3 id="1125-examples">1.12.5 Examples</h3>
<p>The Examples directory also includes Visual C++ project 6 (.dsp) files for building some of the examples on Windows. 
Later versions of Visual Studio will convert these old style project files into a current solution file.</p>

<p>Ensure the SWIG executable is as supplied in the SWIG root directory in order for the examples to work. 
Most languages require some environment variables to be set before running Visual C++. Note that Visual 
C++ must be re-started to pick up any changes in environment variables.</p>

<p>Open up an example .dsp file, Visual C++ will create a workspace for you (.dsw file). Ensure the
Release build is selected then do a Rebuild All from the Build menu. The required environment variables are displayed with their
current values.</p>

<p>Python
PYTHON_INCLUDE : Set this to the directory that contains Python.h<br />
PYTHON_LIB : Set this to the python library including path for linking<br />
Example using Python 2.1.1:  <br />
PYTHON_INCLUDE: D:\python21\include<br />
PYTHON_LIB: D:\python21\libs\python21.lib</p>


                </div>
                <div class="read-all">
                    <a  href="/2016/03/17/swig-1-intro/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
        </ul>



        <!-- Pagination links -->
        <div class="pagination">
          
            <a href="/index.html" class="previous"><i class="fa fa-angle-double-left"></i></a>
            <a href="/page2" class="previous"><i class="fa fa-angle-left"></i></a>
          
          <span class="page_number ">3/3</span>
          
            <span class="next disable"><i class="fa fa-angle-right"></i></span>
            <span class="next disable"><i class="fa fa-angle-double-right"></i></span>
          
        </div>
    </div>
    <!-- <button class="anchor"><i class="fa fa-anchor"></i></button> -->
    <div class="right">
        <div class="wrap">
            <div class="side">
                <div>
                    <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
                    Recent Posts
                </div>
                <ul class="content-ul" recent>
                    
                        <li><a href="/2017/03/12/ccia-3-1-shared-data-protection/">CCIA-3-shared-data-1</a></li>
                    
                        <li><a href="/2017/03/07/csapp-1-preface/">CS:APP-1-Introduction</a></li>
                    
                        <li><a href="/2017/03/06/ccia-2-thread-management/">CCIA-2-basic-thread-mangement</a></li>
                    
                        <li><a href="/2017/03/06/grof-jump-floor/">Frog Jump Floor</a></li>
                    
                        <li><a href="/2017/03/05/gernric-api-introduction/">Generic</a></li>
                    
                        <li><a href="/2017/03/03/ccia-1-hello-world/">CCIA-1-hello-world</a></li>
                    
                        <li><a href="/2017/03/03/algo-is-pop-order/">Is right Pop Sequence ?</a></li>
                    
                        <li><a href="/2017/03/02/tdd-steps/">How to apply tdd</a></li>
                    
                        <li><a href="/2017/03/02/algo-repalce-empty-space/">Replace Empty Space</a></li>
                    
                        <li><a href="/2017/03/01/find-number-in-array/">Find Integer</a></li>
                    
                </ul>
            </div>

            <!-- Content -->
            <div class="side ">
                <div>
                    <i class="fa fa-th-list"></i>
                    Categories
                </div>
                <ul class="content-ul" cate>
                    
                    <li>
                        <a href="/category/#tool" class="categories-list-item" cate="tool">
                            <span class="name">
                                tool
                            </span>
                            <span class="badge">3</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#ipc" class="categories-list-item" cate="ipc">
                            <span class="name">
                                ipc
                            </span>
                            <span class="badge">1</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#logging" class="categories-list-item" cate="logging">
                            <span class="name">
                                logging
                            </span>
                            <span class="badge">1</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#algo" class="categories-list-item" cate="algo">
                            <span class="name">
                                algo
                            </span>
                            <span class="badge">5</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#network" class="categories-list-item" cate="network">
                            <span class="name">
                                network
                            </span>
                            <span class="badge">1</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#test" class="categories-list-item" cate="test">
                            <span class="name">
                                test
                            </span>
                            <span class="badge">1</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#read" class="categories-list-item" cate="read">
                            <span class="name">
                                read
                            </span>
                            <span class="badge">4</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#geco" class="categories-list-item" cate="geco">
                            <span class="name">
                                geco
                            </span>
                            <span class="badge">1</span>
                        </a>
                    </li>
                    
                </ul>
            </div>
            <!-- 其他div框放到这里 -->
            <div class="side">
                <div>
                    <i class="fa fa-tags"></i>
                    Tags
                </div>
                <div class="tags-cloud">
                    
                    
                    
                    

                    

                    
                      
                      
                      
                      
                      
                      <a href="/tag/#swig" style="font-size: 18pt; color: #000;">swig</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#script-language" style="font-size: 18pt; color: #000;">script-language</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#c/c++" style="font-size: 18pt; color: #000;">c/c++</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#os" style="font-size: 13.5pt; color: #444;">os</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#lock-free" style="font-size: 9pt; color: #999;">lock-free</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#debug" style="font-size: 9pt; color: #999;">debug</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#list" style="font-size: 9pt; color: #999;">list</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#ordering" style="font-size: 9pt; color: #999;">ordering</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#endian" style="font-size: 9pt; color: #999;">endian</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#memory" style="font-size: 9pt; color: #999;">memory</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#array" style="font-size: 9pt; color: #999;">array</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#binary-search" style="font-size: 9pt; color: #999;">binary-search</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#stack" style="font-size: 13.5pt; color: #444;">stack</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#tdd" style="font-size: 9pt; color: #999;">tdd</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#thread" style="font-size: 18pt; color: #000;">thread</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#c++" style="font-size: 18pt; color: #000;">c++</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#python" style="font-size: 9pt; color: #999;">python</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#iteration" style="font-size: 9pt; color: #999;">iteration</a>
                    
                </div>
            </div>

            <!-- <div class="side">
                <div>
                    <i class="fa fa-external-link"></i>
                    Links
                </div>
                <ul  class="content-ul">

                </ul>
            </div> -->
        </div>
    </div>
</div>
<!-- <script src="/js/scroll.min.js " charset="utf-8"></script> -->
<!-- <script src="/js/pageContent.js " charset="utf-8"></script> -->


    <footer class="site-footer">


    <div class="wrapper">

        <p class="description">
             For my youth dedicated to coding 
        </p>
        <p class="contact">
            Contact me at: 
            <a href="https://github.com/kiddinglife" title="GitHub"><i class="fa fa-github" aria-hidden="true"></i></a>  
            <a href="mailto:jakezhang1989@hotmail.com" title="email"><i class="fa fa-envelope-o" aria-hidden="true"></i></a>       
            <a href="https://www.linkedin.com/in/kiddinglife" title="LinkedIn"><i class="fa fa-linkedin" aria-hidden="true"></i></a>  
        </p>
        <p>
            本站总访问量<span id="busuanzi_value_site_pv"></span>次，本站访客数<span id="busuanzi_value_site_uv"></span>人次，本文总阅读量<span id="busuanzi_value_page_pv"></span>次
        </p>
        <p class="power">
            <span>
                Site powered by <a href="https://jekyllrb.com/">Jekyll</a> & <a href="https://pages.github.com/">Github Pages</a>.
            </span>
            <span>
                Theme designed by <a href="https://github.com/Gaohaoyang">HyG</a>.
            </span>
        </p>
    </div>
</footer>
<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <div class="back-to-top">
    <a href="#top" data-scroll>
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
    </a>
</div>

    <script src=" /js/main.js " charset="utf-8"></script>
    <script src=" /js/smooth-scroll.min.js " charset="utf-8"></script>
    <script type="text/javascript">
      smoothScroll.init({
        speed: 500, // Integer. How fast to complete the scroll in milliseconds
        easing: 'easeInOutCubic', // Easing pattern to use
        offset: 20, // Integer. How far to offset the scrolling anchor location in pixels
      });
    </script>
    <!-- <script src=" /js/scroll.min.js " charset="utf-8"></script> -->
  </body>

</html>
